diff -u -x .svn -r libraries/Modelica 3.2.1/Modelica/Mechanics/MultiBody/package.mo build/lib/omlibrary/Modelica 3.2.1/Mechanics/MultiBody/package.mo
--- libraries/Modelica 3.2.1/Modelica/Mechanics/MultiBody/package.mo	2013-01-25 21:49:43.336416132 +0100
+++ build/lib/omlibrary/Modelica 3.2.1/Mechanics/MultiBody/package.mo	2013-02-21 15:52:11.673485501 +0100
@@ -1231,6 +1231,7 @@
     "Default scaling of torque arrows (length = torque/defaultNm_to_m)"
     annotation (Dialog(tab="Defaults"));
 
+  /* adrpo: 2012-09-04 -> replace gravityAcceleration function with the one in MSL 3.1 (not replaceable)
   replaceable function gravityAcceleration =
        Modelica.Mechanics.MultiBody.Forces.Internal.standardGravityAcceleration
       (    gravityType=gravityType, g=g*Modelica.Math.Vectors.normalize(n,0.0), mue=mue)
@@ -1249,6 +1250,38 @@
      <a href=\"modelica://Modelica.Mechanics.MultiBody.Examples.Elementary.UserDefinedGravityField\">Examples.Elementary.UserDefinedGravityField</a>.
 </p>
 </html>"));
+*/
+
+function gravityAcceleration = gravityAccelerationTypes (
+      gravityType=gravityType,
+      g=g*Modelica.Math.Vectors.normalize(
+                                     n),
+      mue=mue);
+
+protected
+  function gravityAccelerationTypes
+    "Gravity field acceleration depending on field type and position"
+    import Modelica.Mechanics.MultiBody.Types.GravityTypes;
+    extends Modelica.Icons.Function;
+    input SI.Position r[3]
+      "Position vector from world frame to actual point, resolved in world frame";
+    input GravityTypes gravityType "Type of gravity field";
+    input SI.Acceleration g[3]
+      "Constant gravity acceleration, resolved in world frame, if gravityType=1";
+    input Real mue(unit="m3/s2")
+      "Field constant of point gravity field, if gravityType=2";
+    output SI.Acceleration gravity[3]
+      "Gravity acceleration at point r, resolved in world frame";
+  algorithm
+    gravity := if gravityType == GravityTypes.UniformGravity then g else
+               if gravityType == GravityTypes.PointGravity then
+                  -(mue/(r*r))*(r/Modelica.Math.Vectors.length(
+                                                r)) else
+                    zeros(3);
+    annotation(Inline=true);          
+  end gravityAccelerationTypes;
+
+
 
   /* The World object can only use the Modelica.Mechanics.MultiBody.Visualizers.Advanced.Shape model, but no
      other models in package Modelica.Mechanics.MultiBody.Visualizers, since the other models access
diff -u -x .svn -r libraries/Modelica 3.2.1/Modelica/Media/package.mo build/lib/omlibrary/Modelica 3.2.1/Media/package.mo
--- libraries/Modelica 3.2.1/Modelica/Media/package.mo	2013-01-25 21:49:43.496416137 +0100
+++ build/lib/omlibrary/Modelica 3.2.1/Media/package.mo	2013-02-21 15:52:11.673485501 +0100
@@ -3567,7 +3567,7 @@
                 Inverse_sine_definition.f_nonlinear_Data(A=A, w=w);
       Real x_zero "y_zero = A*sin(w*x_zero)";
 
-   encapsulated package Inverse_sine_definition
+   package Inverse_sine_definition
         "Define sine as non-linear equation to be solved"
         import Modelica;
       extends Modelica.Media.Common.OneNonLinearEquation;
@@ -5524,7 +5524,7 @@
         extends Modelica.Icons.Function;
         input AbsolutePressure p "Pressure";
         input Temperature T "Temperature";
-        input MassFraction X[nX] "Mass fractions";
+        input MassFraction X[:] "Mass fractions";
         input FixedPhase phase=0
         "2 for two-phase, 1 for one-phase, 0 if not known";
         output SpecificEnthalpy h "Specific enthalpy at p, T, X";
@@ -5537,7 +5537,7 @@
         extends Modelica.Icons.Function;
         input AbsolutePressure p "Pressure";
         input SpecificEnthalpy h "Specific enthalpy";
-        input MassFraction X[nX] "Mass fractions";
+        input MassFraction X[:] "Mass fractions";
         input FixedPhase phase=0
         "2 for two-phase, 1 for one-phase, 0 if not known";
         output Temperature T "Temperature";
@@ -5550,7 +5550,7 @@
         extends Modelica.Icons.Function;
         input AbsolutePressure p "Pressure";
         input SpecificEnthalpy h "Specific enthalpy";
-        input MassFraction X[nX] "Mass fractions";
+        input MassFraction X[:] "Mass fractions";
         input FixedPhase phase=0
         "2 for two-phase, 1 for one-phase, 0 if not known";
         output Density d "density";
@@ -5563,7 +5563,7 @@
         extends Modelica.Icons.Function;
         input AbsolutePressure p "Pressure";
         input SpecificEntropy s "Specific entropy";
-        input MassFraction X[nX] "Mass fractions";
+        input MassFraction X[:] "Mass fractions";
         input FixedPhase phase=0
         "2 for two-phase, 1 for one-phase, 0 if not known";
         output Temperature T "Temperature";
@@ -5576,7 +5576,7 @@
         extends Modelica.Icons.Function;
         input AbsolutePressure p "Pressure";
         input SpecificEntropy s "Specific entropy";
-        input MassFraction X[nX] "Mass fractions";
+        input MassFraction X[:] "Mass fractions";
         input FixedPhase phase=0
         "2 for two-phase, 1 for one-phase, 0 if not known";
         output Density d "Density";
@@ -5589,7 +5589,7 @@
         extends Modelica.Icons.Function;
         input AbsolutePressure p "Pressure";
         input SpecificEntropy s "Specific entropy";
-        input MassFraction X[nX] "Mass fractions";
+        input MassFraction X[:] "Mass fractions";
         input FixedPhase phase=0
         "2 for two-phase, 1 for one-phase, 0 if not known";
         output SpecificEnthalpy h "specific enthalpy";
@@ -6288,7 +6288,7 @@
       extends Modelica.Icons.Function;
       input AbsolutePressure p "Pressure";
       input SpecificEnthalpy h "Specific enthalpy";
-      input MassFraction X[nX] "Mass fractions";
+      input MassFraction X[:] "Mass fractions";
       output Temperature T "Temperature";
     algorithm
       T := h/cp_const + T0;
diff -u -x .svn -r libraries/Modelica 3.2.1/Modelica/Media/Water/IF97_Utilities.mo build/lib/omlibrary/Modelica 3.2.1/Media/Water/IF97_Utilities.mo
--- libraries/Modelica 3.2.1/Modelica/Media/Water/IF97_Utilities.mo	2013-02-18 14:23:52.240727649 +0100
+++ build/lib/omlibrary/Modelica 3.2.1/Media/Water/IF97_Utilities.mo	2013-02-21 15:52:11.677485501 +0100
@@ -6824,7 +6824,7 @@
     aux.region := if region == 0 then BaseIF97.Regions.region_pT(p=p,T= T) else region;
     aux.R := BaseIF97.data.RH2O;
     aux.p := p;
-    aux.T := T;
+    aux.T := T; /* OpenModelica patch */ aux.dpT := 0.0; aux.pt := 0.0; aux.pd := 0.0; aux.x := 0.0; aux.rho := 0.0; aux.vt := 0.0; aux.vp := 0.0; aux.cp := 0.0; /* end OpenModelica patch */
     if (aux.region == 1) then
       g := BaseIF97.Basic.g1(p, T);
       aux.h := aux.R*aux.T*g.tau*g.gtau;
diff -u -x .svn -r libraries/Modelica 3.2.1/Modelica/Media/Water/package.mo build/lib/omlibrary/Modelica 3.2.1/Media/Water/package.mo
--- libraries/Modelica 3.2.1/Modelica/Media/Water/package.mo	2013-01-25 21:49:43.504416137 +0100
+++ build/lib/omlibrary/Modelica 3.2.1/Media/Water/package.mo	2013-02-21 15:52:11.677485501 +0100
@@ -3,7 +3,7 @@
 
 
   extends Modelica.Icons.MaterialPropertiesPackage;
-
+  import Modelica.Media.Water.ConstantPropertyLiquidWater.simpleWaterConstants;
 
 package IdealSteam "Water: Steam as ideal gas from NASA source"
 
